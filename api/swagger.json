{"openapi":"3.0.0","info":{"title":"EasyAppz API","version":"1.0.0","description":"API documentation for EasyAppz"},"servers":[{"url":"http://localhost:3000/api"}],"paths":{"/applications/{applicationId}/files/file":{"delete":{"summary":"Удаление файла приложения","description":"Удаляет указанный файл приложения. В теле запроса необходимо указать путь к файлу, который требуется удалить.","tags":["Application Files"],"parameters":[{"in":"path","name":"applicationId","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"filePath":{"type":"string","description":"Путь к файлу, который необходимо удалить.","example":"src/app.js"}}}}}},"responses":{"200":{"description":"Файл успешно удален","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"File deleted successfully"}}}}}},"500":{"description":"Ошибка сервера или приложение не найдено","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}},"get":{"summary":"Получение содержимого файла приложения","description":"Возвращает содержимое указанного файла для заданного приложения. Путь к файлу передается через query параметр filePath.","tags":["Application Files"],"parameters":[{"in":"path","name":"applicationId","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения."},{"in":"query","name":"filePath","required":true,"schema":{"type":"string"},"description":"Путь к файлу, содержимое которого нужно получить."}],"responses":{"200":{"description":"Содержимое файла успешно получено.","content":{"application/json":{"schema":{"type":"object","properties":{"content":{"type":"string","example":"console.log('Hello World');"}}}}}},"500":{"description":"Ошибка сервера или приложение не найдено.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}},"put":{"summary":"Обновление содержимого файла приложения","description":"Обновляет содержимое указанного файла для заданного приложения.","tags":["Application Files"],"parameters":[{"in":"path","name":"applicationId","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"filePath":{"type":"string","description":"Путь к файлу, который необходимо обновить.","example":"src/app.js"},"content":{"type":"string","description":"Новое содержимое файла.","example":"console.log('Updated content');"}}}}}},"responses":{"200":{"description":"Файл успешно обновлен","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"File updated successfully"}}}}}},"500":{"description":"Ошибка сервера или приложение не найдено","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}}},"/applications/{id}/files":{"get":{"summary":"Получение списка файлов приложения","description":"Возвращает иерархический список всех файлов и папок приложения","tags":["Application Files"],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения."}],"responses":{"200":{"description":"Список файлов успешно получен","content":{"application/json":{"schema":{"type":"object","properties":{"files":{"type":"array","items":{"$ref":"#/components/schemas/FileSystemItem"}}}}}}},"500":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}}},"/applications/{id}":{"get":{"summary":"Получение приложения по ID","description":"Возвращает приложение с указанным идентификатором.","tags":["Applications"],"parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения."}],"responses":{"200":{"description":"Приложение успешно получено.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MongoModelApplication"}}}},"404":{"description":"Приложение не найдено.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"No application found by, {id}"}}}}}},"500":{"description":"Ошибка сервера.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}}},"/applications/{applicationId}/logs":{"get":{"summary":"Получить логи приложения","description":"Возвращает список логов для указанного приложения.","tags":["Логи приложения"],"parameters":[{"in":"path","name":"applicationId","required":true,"description":"Идентификатор приложения.","schema":{"type":"string"}}],"responses":{"200":{"description":"Список логов приложения успешно получен.","content":{"application/json":{"schema":{"type":"object","properties":{"logs":{"type":"array","items":{"$ref":"#/components/schemas/IMongoModelLog"}}}}}}},"400":{"description":"Неверный запрос, идентификатор приложения отсутствует.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Application id is required"}}}}}},"500":{"description":"Внутренняя ошибка сервера.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}}},"/applications/{applicationId}/messages/{messageId}/cancel":{"post":{"summary":"Отменить промты сообщения","description":"Отменяет все необработанные промты для указанного сообщения, устанавливает статус сообщения в \"completed\" и очищает ошибку приложения.","tags":["Application Messages"],"parameters":[{"in":"path","name":"applicationId","required":true,"description":"Идентификатор приложения.","schema":{"type":"string"}},{"in":"path","name":"messageId","required":true,"description":"Идентификатор сообщения.","schema":{"type":"string"}}],"responses":{"200":{"description":"Сообщение успешно остановлено.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"message":{"type":"string","example":"Сообщение успешно остановлено"}}}}}},"404":{"description":"Сообщение или приложение не найдены.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Message not found"}}}}}},"500":{"description":"Внутренняя ошибка сервера при отмене промтов.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Server error while retrying prompts"}}}}}}}}},"/applications/{applicationId}/messages/{messageId}/retry":{"post":{"summary":"Повторная обработка промтов сообщения","description":"Находит сообщение по идентификатору, проверяет существование связанного приложения, обновляет все промты  с статусом \"error\" на \"created\" для этого сообщения и отправляет его в очередь для срочной обработки.\n","tags":["Message"],"parameters":[{"in":"path","name":"messageId","required":true,"schema":{"type":"string"},"description":"Идентификатор сообщения"},{"in":"path","name":"applicationId","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения"}],"responses":{"200":{"description":"Промты успешно обновлены и сообщение отправлено в очередь для обработки.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"message":{"type":"string","example":"Prompts successfully updated"}}}}}},"404":{"description":"Сообщение, приложение или промты со статусом \"error\" не найдены.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Message not found"}}}}}},"500":{"description":"Ошибка сервера при повторной обработке промтов.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Server error while retrying prompts"}}}}}}}}},"/applications/{applicationId}/messages":{"get":{"summary":"Получение сообщений и промтов для приложения","description":"Возвращает массив сообщений для указанного приложения. Каждое сообщение включает поля id, content, role, status и вложенный массив promts, содержащий объекты с полями content, result и status.\n","tags":["Application Messages"],"parameters":[{"in":"path","name":"applicationId","required":true,"schema":{"type":"string"},"description":"Идентификатор приложения."}],"responses":{"200":{"description":"Сообщения успешно получены.","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"Идентификатор сообщения.","example":"60ad0cedf72e4e3ef1234567"},"content":{"type":"string","description":"Содержимое сообщения.","example":"Hello world"},"role":{"type":"string","description":"Роль отправителя (user или assistant).","example":"assistant"},"status":{"type":"string","description":"Статус сообщения.","example":"completed"},"promts":{"type":"array","description":"Список промтов, связанных с сообщением.","items":{"type":"object","properties":{"content":{"type":"string","description":"Содержимое промта.","example":"Пожалуйста, перефразируй..."},"result":{"type":"string","description":"Результат выполнения промта.","example":"Перефразированный текст"},"status":{"type":"string","description":"Статус промта.","example":"completed"}}}}}}}}}},"500":{"description":"Ошибка сервера.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}},"post":{"summary":"Создание сообщения для приложения","description":"Создает новое сообщение для указанного приложения.","tags":["Messages"],"parameters":[{"in":"path","name":"applicationId","schema":{"type":"string"},"required":true,"description":"Идентификатор приложения"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"content":{"type":"string","description":"Содержимое сообщения","example":"This is a message content."}}}}}},"responses":{"200":{"description":"Сообщение успешно создано","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":false},"message":{"type":"string","description":"Сообщение о статусе","example":"Приложение в процессе создания."}}}}}},"400":{"description":"Неверные параметры запроса","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Такой модели ИИ не существует"}}}}}},"500":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Ошибка сервера"}}}}}}}}},"/applications/{applicationId}/restart":{"post":{"summary":"Перезагрузить приложение","description":"Очищает поле deployingError у указанного приложения, сигнализируя о том, что ошибка деплоя устранена.","tags":["Application"],"parameters":[{"in":"path","name":"applicationId","description":"Идентификатор приложения.","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Поле deployingError успешно очищено.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"message":{"type":"string","example":"Deploying error cleared successfully"}}}}}},"400":{"description":"Идентификатор приложения не указан.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Application id is required"}}}}}},"404":{"description":"Приложение не найдено.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Application not found"}}}}}},"500":{"description":"Внутренняя ошибка сервера.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}}},"/applications":{"get":{"summary":"Получение списка приложений для пользователя","description":"Возвращает список всех приложений, принадлежащих аутентифицированному пользователю (req.user).","tags":["Application"],"responses":{"200":{"description":"Список приложений успешно получен","content":{"application/json":{"schema":{"type":"object","properties":{"applications":{"type":"array","items":{"$ref":"#/components/schemas/IMongoModelApplication"}}}}}}},"401":{"description":"Пользователь не авторизован","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Unauthorized"}}}}}},"500":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}},"post":{"summary":"Создание нового приложения","description":"Создает новое приложение с указанными параметрами.","tags":["Application"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"Название приложения.","example":"My Application"},"description":{"type":"string","description":"Описание приложения.","example":"This is a description of my application."},"template":{"type":"string","description":"Шаблон приложения.","example":"html-vanilla"},"modelAi":{"type":"string","description":"Модель искусственного интеллекта.","example":"gpt-4o-mini-chat"}}}}}},"responses":{"201":{"description":"Приложение успешно создано.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IMongoModelApplication"}}}},"400":{"$ref":"#/components/responses/BadRequest"},"500":{"$ref":"#/components/responses/ServerError"}}}},"/config":{"get":{"summary":"Получение конфигурации приложения","description":"Возвращает конфигурацию, содержащую список шаблонов и список моделей AI.","tags":["Config"],"responses":{"200":{"description":"Конфигурация успешно получена.","content":{"application/json":{"schema":{"type":"object","properties":{"templates":{"type":"array","description":"Список шаблонов приложения.","items":{"type":"object","properties":{"id":{"type":"string","description":"Идентификатор шаблона.","example":"template1"},"description":{"type":"string","description":"Описание шаблона.","example":"Описание шаблона 1"}}}},"modelsAi":{"type":"array","description":"Список ключей (идентификаторов) моделей AI.","items":{"type":"string","example":"gpt-4"}}}}}}},"500":{"description":"Ошибка сервера.","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Internal server error"}}}}}}}}},"/user":{"get":{"summary":"Получение данных пользователя","description":"Возвращает данные аутентифицированного пользователя.","tags":["User"],"responses":{"200":{"description":"Данные пользователя успешно получены","content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string","description":"Email пользователя","example":"user@example.com"},"name":{"type":"string","description":"Имя пользователя","example":"User Name"}}}}}},"401":{"description":"Пользователь не авторизован","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Unauthorized"}}}}}},"500":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Internal server error"}}}}}}}},"post":{"summary":"Создание нового пользователя","description":"Создает нового пользователя с указанным email.","tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string","description":"Email пользователя","example":"user@example.com"}}}}}},"responses":{"201":{"description":"Пользователь успешно создан","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":false},"message":{"type":"string","description":"Сообщение о статусе","example":"User created successfully"}}}}}},"500":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Internal server error"}}}}}}}}},"/user/login":{"post":{"summary":"Вход пользователя","description":"Вход пользователя с указанным email и кодом.","tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string","description":"Email пользователя","example":"user@example.com"},"code":{"type":"string","description":"Код пользователя","example":"123456"}}}}}},"responses":{"200":{"description":"Вход успешен","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":false},"message":{"type":"string","description":"Сообщение о статусе","example":"Login successful"}}}}}},"401":{"description":"Неверный email или код","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Invalid email or code"}}}}}},"500":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Internal server error"}}}}}}}}},"/promts/analyze":{"post":{"summary":"Анализ сообщения","tags":["Promts"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","description":"Сообщение для анализа","example":"Пример сообщения"}}}}}},"responses":{"200":{"description":"Анализ выполнен успешно","content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"Имя, назначенное на основе анализа","example":"Prompt Name"},"description":{"type":"string","description":"Описание, сформированное на основе сообщения","example":"Prompt description based on message"},"template":{"type":"string","description":"Выбранный шаблон"},"modelAi":{"type":"string","description":"Выбранный искуственный интелект"}}}}}},"500":{"description":"Ошибка сервера при анализе","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Статус ошибки","example":true},"message":{"type":"string","description":"Сообщение об ошибке","example":"Internal server error"}}}}}}}}}},"components":{"schemas":{"FileSystemItem":{"type":"object","properties":{"name":{"type":"string"},"type":{"type":"string","enum":["file","directory"]},"path":{"type":"string"},"children":{"type":"array","items":{"$ref":"#/components/schemas/FileSystemItem"}}}},"IMongoModelLog":{"type":"object","properties":{"_id":{"type":"string","description":"Идентификатор лога.","example":"605f8b34b661f17d2c9d2fe2"},"application":{"type":"string","description":"Идентификатор приложения, к которому привязан лог.","example":"603dcd3e2f1b2c001c8e4e1a"},"content":{"type":"string","description":"Сообщение лога.","example":"Контейнер запущен успешно."},"type":{"type":"string"},"status":{"type":"string"},"createdAt":{"type":"string","format":"date-time","description":"Дата и время создания лога.","example":"2023-12-31T23:59:59.000Z"}}},"IMongoModelApplication":{"type":"object","properties":{"_id":{"type":"string","description":"Идентификатор приложения.","example":"603dcd3e2f1b2c001c8e4e1a"},"name":{"type":"string","description":"Название приложения.","example":"My Application"},"description":{"type":"string","description":"Описание приложения.","example":"This is a description of my application."},"usedTokensInput":{"type":"number","description":"Количество использованных входящих токенов.","example":123},"usedTokensOutput":{"type":"number","description":"Количество использованных исходящих токенов.","example":456},"port":{"type":"number","description":"Порт, на котором запущено приложение.","example":3000},"dir":{"type":"string","description":"Директория приложения.","example":"/path/to/application"},"domain":{"type":"string","description":"Домен приложения.","example":"sub.easyappz.ru"},"template":{"type":"string","description":"Шаблон приложения.","example":"html-vanilla"},"pending":{"type":"boolean","description":"Статус ожидания (pending) приложения.","example":true},"modelAi":{"type":"string","description":"Модель искусственного интеллекта.","example":"gpt-4o-mini-chat"},"version":{"type":"string","description":"Версия приложения.","example":"1.0.0"},"error":{"type":"string","description":"Текст ошибки при создании или работе приложения (если есть).","example":""},"warning":{"type":"string"},"user":{"type":"string","description":"Идентификатор пользователя, создавшего приложение.","example":"603dcd3e2f1b2c001c8e4e1b"},"createdAt":{"type":"string","format":"date-time","description":"Дата и время создания приложения.","example":"2023-12-31T23:59:59.000Z"},"updatedAt":{"type":"string","format":"date-time","description":"Дата и время последнего обновления приложения.","example":"2024-01-01T00:00:00.000Z"}}}},"responses":{"ServerError":{"description":"Ошибка сервера","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean"},"message":{"type":"string","example":"Doesnt create createdApplication"}}}}}},"BadRequest":{"description":"Неверные параметры запроса","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean"},"message":{"type":"string","example":"Такой модели ИИ не существует"}}}}}}}},"tags":[]}